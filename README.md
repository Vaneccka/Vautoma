# PAROPLAN Web Application

## Описание Проекта

PAROPLAN — это веб-приложение на Flask, предназначенное для демонстрации современных подходов к веб-разработке, включая модульную структуру с использованием Blueprints, интеграцию с внешними API (в данном случае, AI-моделей DeepSeek и OpenAI), а также создание динамических веб-страниц. Проект имеет чистую архитектуру, легко масштабируется и кастомизируется.

Ключевые особенности:
- **Модульность**: Использование Flask Blueprints для разделения функциональности на логические компоненты (например, `main`, `ai`, `about`, `contact`, `privacy`).
- **Генератор Страниц**: Скрипт `generate.py` для автоматического создания новых модулей (blueprints) с базовой структурой (Python-файлы, HTML-шаблоны, CSS и JS файлы).
- **Интеграция с AI**: Модуль `ai` демонстрирует асинхронное взаимодействие с API моделей DeepSeek и OpenAI для реализации чат-бота.
- **Современный Frontend**: Использование Jinja2 для шаблонизации, адаптивный дизайн, продуманная структура CSS и JavaScript.
- **Конфигурация Брендбука**: Централизованное управление стилями и цветами через `config/brandbook.json`.
- **Универсальные Шаблоны**: `base.html` и шаблон для генерируемых страниц спроектированы для легкого расширения и кастомизации.

## Структура Проекта

```
/paroplan_003
├── app/                    # Основная директория приложения
│   ├── __init__.py         # Инициализация Flask приложения и регистрация Blueprints
│   ├── static/             # Глобальные статические файлы (CSS, JS, изображения)
│   │   ├── css/style.css   # Глобальные стили
│   │   └── ...             # Другие глобальные ресурсы
│   ├── templates/          # Глобальные шаблоны
│   │   └── base.html       # Базовый HTML-шаблон
│   ├── main/               # Blueprint для главной страницы
│   │   ├── __init__.py
│   │   ├── routes.py
│   │   └── templates/main/main.html
│   ├── ai/                 # Blueprint для AI-чата
│   │   ├── __init__.py
│   │   ├── routes.py
│   │   ├── ai_models.py    # Логика взаимодействия с AI API
│   │   └── templates/ai/index.html
│   │   └── static/ai/css/style.css # Стили для страницы AI
│   ├── about/              # Blueprint для страницы "О нас"
│   ├── contact/            # Blueprint для страницы контактов
│   ├── privacy/            # Blueprint для политики конфиденциальности
│   └── ...                 # Другие модули (Blueprints)
├── config/
│   └── brandbook.json      # Конфигурация цветов и стилей брендбука
├── generate.py             # Скрипт для генерации новых модулей/страниц
├── run.py                  # Точка входа для запуска Flask-приложения
├── requirements.txt        # Список зависимостей Python
├── todo.md                 # Список задач по проекту (для разработки)
└── README.md               # Этот файл
```

## Инструкции по Запуску Проекта

### 1. Предварительные требования:
- Python 3.10+ (рекомендуется 3.11)
- `pip` (менеджер пакетов Python)
- (Опционально) `virtualenv` или `venv` для создания изолированного окружения

### 2. Клонирование репозитория (если применимо):
Если проект находится в Git-репозитории, склонируйте его:
```bash
git clone <URL_репозитория>
cd paroplan_003
```
Если вы получили проект в виде архива, распакуйте его.

### 3. Создание и активация виртуального окружения (рекомендуется):
```bash
python -m venv venv
# Для Windows:
# venv\Scripts\activate
# Для macOS/Linux:
# source venv/bin/activate
```

### 4. Установка зависимостей:
Убедитесь, что вы находитесь в корневой директории проекта (`paroplan_003`), где лежит файл `requirements.txt`.
```bash
pip install -r requirements.txt
```

### 5. Настройка переменных окружения (API ключи):
Для работы AI-чата необходимо указать API-ключи для DeepSeek и OpenAI. Создайте файл `.env` в корневой директории проекта (`paroplan_003`) и добавьте в него ваши ключи:

**.env**
```
DEEPSEEK_API_KEY="ваш_ключ_deepseek"
OPENAI_API_KEY="ваш_ключ_openai"
```

**Важно**: Не добавляйте файл `.env` в систему контроля версий, если вы используете Git. Добавьте `.env` в ваш `.gitignore` файл.

### 6. Запуск приложения:
```bash
python run.py
```
После запуска, приложение будет доступно по адресу `http://127.0.0.1:5000/` (или по другому адресу, если он указан в выводе консоли).

## Руководство по Добавлению Нового Контента/Страниц

Для добавления новой страницы (например, "services") используется скрипт `generate.py`.

1.  **Активируйте виртуальное окружение** (если еще не активно).
2.  **Перейдите в корневую директорию проекта** (`paroplan_003`).
3.  **Запустите скрипт `generate.py`**, указав имя новой страницы в нижнем регистре:
    ```bash
    python generate.py services
    ```
    Это создаст следующую структуру:
    -   `app/services/__init__.py` (инициализация Blueprint)
    -   `app/services/routes.py` (маршруты для страницы)
    -   `app/services/templates/services/index.html` (HTML-шаблон страницы)
    -   `app/static/services/css/style.css` (CSS-файл для страницы)
    -   `app/static/services/js/script.js` (JavaScript-файл для страницы)

    Скрипт также автоматически зарегистрирует новый Blueprint в `app/__init__.py`.

4.  **Настройте контент страницы**:
    -   Отредактируйте `app/services/templates/services/index.html` для добавления HTML-содержимого.
    -   Добавьте специфичные стили в `app/static/services/css/style.css`.
    -   Добавьте JavaScript-логику в `app/static/services/js/script.js`.
    -   При необходимости, измените логику в `app/services/routes.py` (например, для передачи дополнительных данных в шаблон).

5.  **Добавьте ссылку на новую страницу** в навигацию (например, в `app/templates/base.html` или в соответствующем блоке навигации).

6.  **Перезапустите Flask-приложение**, если оно было запущено, чтобы изменения вступили в силу.

## Инструкции по Использованию Импортируемых Библиотек

### 1. Flask
-   **Назначение**: Микрофреймворк для создания веб-приложений на Python.
-   **Установка**: `pip install Flask` (уже включен в `requirements.txt`).
-   **Использование в проекте**:
    -   `app/__init__.py`: Создание экземпляра `Flask`, конфигурация приложения, регистрация Blueprints.
    -   `run.py`: Точка входа для запуска сервера разработки Flask.
    -   Blueprints (например, `app/main/routes.py`): Определение маршрутов (`@blueprint_name.route('/')`), обработка запросов, рендеринг шаблонов (`render_template`).
    -   Шаблоны Jinja2 (`.html` файлы в папках `templates`): Динамическая генерация HTML с использованием переменных, циклов, условных конструкций и наследования шаблонов (`{% extends 'base.html' %}`, `{{ variable }}`, `{% block content %}`).
-   **Документация**: [Flask Documentation](https://flask.palletsprojects.com/)

### 2. aiohttp
-   **Назначение**: Асинхронная HTTP-клиент/серверная библиотека для Python (используется для асинхронных HTTP-запросов к AI API).
-   **Установка**: `pip install aiohttp` (уже включен в `requirements.txt`).
-   **Использование в проекте**:
    -   `app/ai/ai_models.py`: Создание `aiohttp.ClientSession()` для выполнения асинхронных POST-запросов к API DeepSeek и OpenAI.
    -   Пример:
        ```python
        async with aiohttp.ClientSession() as session:
            async with session.post(url, headers=headers, json=payload) as response:
                return await response.json()
        ```
-   **Документация**: [aiohttp Documentation](https://docs.aiohttp.org/)

### 3. openai
-   **Назначение**: Официальная Python-библиотека для взаимодействия с API OpenAI (GPT модели).
-   **Установка**: `pip install openai` (уже включен в `requirements.txt`).
-   **Использование в проекте**:
    -   Хотя в текущей реализации `app/ai/ai_models.py` используется `aiohttp` для прямых запросов к API, библиотека `openai` может быть использована для более удобного взаимодействия, если это предпочтительнее. В данном проекте она указана как зависимость, так как часто используется в подобных интеграциях.
    -   Если бы использовалась напрямую:
        ```python
        # from openai import OpenAI # или AsyncOpenAI
        # client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))
        # response = client.chat.completions.create(...)
        ```
-   **Документация**: [OpenAI Python Library](https://github.com/openai/openai-python)

### 4. python-dotenv
-   **Назначение**: Чтение переменных окружения из файла `.env`.
-   **Установка**: `pip install python-dotenv` (уже включен в `requirements.txt`).
-   **Использование в проекте**:
    -   `app/__init__.py` (или `run.py`, если конфигурация загружается там): Загрузка переменных из `.env` файла в переменные окружения ОС.
        ```python
        from dotenv import load_dotenv
        load_dotenv() # Загружает переменные из .env файла
        # После этого os.getenv("MY_VARIABLE") будет работать
        ```
    -   Это позволяет безопасно хранить API-ключи и другие конфигурационные данные вне кода.
-   **Документация**: [python-dotenv on PyPI](https://pypi.org/project/python-dotenv/)

### 5. Взаимодействие с DeepSeek API (через aiohttp)
-   **Назначение**: В проекте реализовано взаимодействие с API DeepSeek для получения ответов от AI-модели. Так как официальная Python-библиотека `deepseek-api` на момент создания этого README отсутствует или не используется, запросы выполняются напрямую через HTTP с использованием `aiohttp`.
-   **Установка**: Не требуется отдельная установка специфичной библиотеки для DeepSeek, так как используется `aiohttp` (уже включен в `requirements.txt`).
-   **Использование в проекте**:
    -   В `app/ai/ai_models.py` показан пример прямого асинхронного POST-запроса к эндпоинту DeepSeek API.
    -   Для работы требуется `DEEPSEEK_API_KEY` в файле `.env`.
-   **Документация**: Необходимо обратиться к официальной документации DeepSeek API для получения актуальной информации об эндпоинтах и формате запросов.

### Стандартные библиотеки Python (не требуют отдельной установки через pip):
-   **os**: Взаимодействие с операционной системой (например, `os.getcwd()`, `os.path.join()`, `os.getenv()`).
-   **sys**: Доступ к системным параметрам и функциям (например, `sys.argv`, `sys.exit()`).
-   **json**: Работа с данными в формате JSON (кодирование и декодирование).
-   **asyncio**: Поддержка асинхронного программирования (используется с `aiohttp`).
-   **logging**: Ведение логов приложения.

## Устранение Неполадок

-   **`ModuleNotFoundError`**: Убедитесь, что вы активировали виртуальное окружение и установили все зависимости из `requirements.txt`.
-   **`TemplateNotFound` (или `TemplateAssertionError`)**: Проверьте правильность путей к шаблонам в функциях `render_template` и структуру папок `templates` внутри каждого Blueprint. Убедитесь, что имя шаблона указано корректно (например, `main/main.html`, а не просто `main.html`). Также проверьте, что `base.html` находится в `app/templates/`.
-   **Ошибки API-ключей**: Убедитесь, что файл `.env` создан в корневой директории проекта, содержит корректные API-ключи, и что `load_dotenv()` вызывается в приложении перед попыткой доступа к ключам.
-   **Статические файлы не загружаются (CSS/JS)**: Проверьте конфигурацию `static_folder` и `static_url_path` для приложения и для каждого Blueprint. Убедитесь, что `url_for('static', filename='...')` или `url_for('blueprint_name.static', filename='...')` используются корректно в шаблонах.

## Дальнейшие Улучшения (Предложения)

-   Добавление базы данных (например, Flask-SQLAlchemy) для хранения данных.
-   Реализация аутентификации пользователей.
-   Написание тестов (unit-тесты, интеграционные тесты).
-   Более продвинутая обработка ошибок и логирование.
-   Развертывание приложения на хостинге (например, Heroku, PythonAnywhere, Docker).

Надеемся, это руководство поможет вам в работе с проектом PAROPLAN!

